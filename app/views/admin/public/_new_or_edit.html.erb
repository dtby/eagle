<%= form_for([:admin, item], remote: true, format: :js) do |f| %>
	<div class="form-group">
		<div class="input-group m-b">
			<span class="input-group-addon"><span class="glyphicon glyphicon-user"></span></span>
			<%= f.text_field :name, class: "form-control", placeholder: "姓名" %>
		</div>
		<% if item.errors[:name].any? %>
			<dd class="error text-danger"><%= item.errors[:name][0] %></dd>
		<% end %>
	</div>

	<div class="form-group">
		<div class="input-group m-b">
			<span class="input-group-addon"><span class="glyphicon glyphicon-phone"></span></span>
			<%= f.text_field :phone, class: "form-control", placeholder: "手机号码" %>
		</div>
		<% if item.errors[:phone].any? %>
			<dd class="error text-danger"><%= item.errors[:phone][0] %></dd>
		<% end %>
	</div>

	<div class="form-group">
		<div class="input-group m-b">
			<span class="input-group-addon"><span class="glyphicon glyphicon-envelope"></span></span>
			<%= f.email_field :email, class: "form-control", placeholder: "邮箱" %>
		</div>
		<% if item.errors[:email].any? %>
			<dd class="error text-danger"><%= item.errors[:email][0] %></dd>
		<% end %>
	</div>

	<div class="form-group">     
		<div class="input-group m-b">
			<span class="input-group-addon"><span class="glyphicon glyphicon-lock"></span></span>    
			<%= f.password_field :password, autocomplete: "off", class: "form-control", placeholder: "#{ item.name.empty? ? "设置密码(不小于6个字符)" : "更新密码(不填写则不更新密码)" }" %>   
		</div>
		<% if item.errors[:password].any? %>
			<dd class="error text-danger"><%= item.errors[:password][0] %></dd>
		<% end %>
	</div>

	<div class="form-group">     
		<div class="input-group m-b">
			<span class="input-group-addon"><span class="glyphicon glyphicon-lock"></span></span>    
			<%= f.password_field :password_confirmation, autocomplete: "off", class: "form-control", placeholder: "#{ item.name.empty? ? "确认密码" : "确认密码(不填写则不更新密码)" }" %>   
		</div>
		<% if item.errors[:password_confirmation].any? %>
			<dd class="error text-danger"><%= item.errors[:password_confirmation][0] %></dd>
		<% end %>
	</div>

	<% if params[:controller] == "admin/users" %>
		<% if params[:action] == "edit" %>
			<div id="selected_rooms" class="sr-only">
				<% user_rooms.each do |room| %>
				<span><%= room.name %>,<%= room.id %>,</span>			
				<% end %>
			</div>
		<% end %>
		<div class="input-group" style="width: 100%;">
			<%= select_tag :user_rooms, options_from_collection_for_select(rooms, "id", "name"), multiple: true, 
			class: "chosen-select", style: "width:100%", tabindex: "4", prompt: "所有机房", "data-placeholder" => "机房(多选)" %>
		</div>
		<br>
	<% end %>

	<div class="actions">
		<%= f.submit "#{params[:id].present? ? '更新' : '创建'}", class: "btn btn-success btn-block" %>
	</div>
	<p></p>
<% end %>

<script>
	//配置多选表单
      var config = {
            '.chosen-select'           : {},
            '.chosen-select-deselect'  : {allow_single_deselect:true},
            '.chosen-select-no-single' : {disable_search_threshold:10},
            '.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
            '.chosen-select-width'     : {width:"90%"}
      }
      for (var selector in config) {
            $(selector).chosen(config[selector]);
      }

      $(function(){
      	      //编辑时多选表单已选内容
	      var selected = $("#selected_rooms span").text().split(",");
	      var choices = "";
	      var i;
	      for(i = 0; selected[i] != ""; i++){
	      		choices += "<li class='search-choice'><span>" + selected[i] + "</span><a class='search-choice-close' data-option-array-index='" + selected[++i] + "'></a></li>"
	      }
	      var search = "<li class='search-field'><input type='text' value='' class='' autocomplete='off' style='width: 25px;' tabindex='4'></li>"
	      $(".chosen-choices").html(choices + search);
      })
</script>